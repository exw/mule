
Desugared:

	(Lam
	 ($0
	  (Let
	   (choice
	    (App
	     ((WithType
	       (Quant
	        (() All a (Fn (() (Var (() a)) (Fn (() (Var (() a)) (Var (() a)))))))))
	      (Var $0)))
	    (App
	     ((Fix Record)
	      (Lam
	       ($1
	        (App
	         ((App
	           ((Update (Value x))
	            (App
	             ((App ((Update (Value y)) EmptyRecord))
	              (App
	               ((App ((Var choice) (Lam (x (Var x))))) (Lam (x (Var x)))))))))
	          (App ((App ((Var choice) EmptyRecord)) EmptyRecord))))))))))))

inferred type:

	(Quant
	 (() All a
	  (Quant
	   (() All b
	    (Quant
	     (() All c
	      (Quant
	       (() Exist d
	        (Fn
	         (() (Fn (() (Var (() d)) (Fn (() (Var (() d)) (Var (() d))))))
	          (Record (r_info ()) (r_types (() () (c)))
	           (r_values
	            (()
	             ((x
	               (Record (r_info ()) (r_types (() () (b)))
	                (r_values (() () ()))))
	              (y (Fn (() (Var (() a)) (Var (() a))))))
	             ())))))))))))))

Runtime term:

	(Lam
	 (0 ()
	  (App
	   ((Lam
	     (0 ()
	      (App
	       ((Fix Record)
	        (Lam
	         (1 ()
	          (Record
	           ((x (App ((App ((Var 1) (Record ()))) (Record ()))))
	            (y
	             (App
	              ((App ((Var 1) (Lam (0 () (Var 0))))) (Lam (0 () (Var 0))))))))))))))
	    (Var 0)))))

Evaluated:

	(Lam
	 (0 ()
	  (App
	   ((Lam
	     (0 ()
	      (App
	       ((Fix Record)
	        (Lam
	         (1 ()
	          (Record
	           ((x (App ((App ((Var 1) (Record ()))) (Record ()))))
	            (y
	             (App
	              ((App ((Var 1) (Lam (0 () (Var 0))))) (Lam (0 () (Var 0))))))))))))))
	    (Var 0)))))
